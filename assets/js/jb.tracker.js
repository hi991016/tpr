document.write(
  '<style type="text/css"> #signupFormOverlay_VGQ9D, #signupFormVeil_VGQ9D {position: fixed; width: 100%; height: 100%; overflow: hidden; top: 0; left: 0;border: none;}#signupFormVeil_VGQ9D {width: calc(100% - 16px);} #signupFormOverlay_VGQ9D { z-index: 777777; background-color: rgba(0, 0, 0, 0.7); } #signupFormContent_VGQ9D > div.formbox-editor_VGQ9D {position: absolute;} #signupFormVeil_VGQ9D {opacity: 0;} #signupFormContent_VGQ9D.position-centered  > div.formbox-editor_VGQ9D {position: relative;} #signupFormContainer_VGQ9D, #signupFormContent_VGQ9D {z-index: 888888;position: fixed;width: 100%;height: 100%;border: none;top: 0;left: 0;-webkit-animation-fill-mode: forwards;animation-fill-mode: forwards;overflow: auto;} #signupFormContainer_VGQ9D {overflow: hidden;} #close-btn_VGQ9D svg {display: block;}  #close-btn_VGQ9D path {fill: #000000;}#signupFormContainer_VGQ9D > #close-btn_VGQ9D { right: 20px!important; top: 20px!important; }  #close-btn_VGQ9D {position:absolute;cursor: pointer;z-index: 999999;font-size: 20px;display:block; top: 10px; right: 10px;color: #000000;background-color: ;border-radius:0px;} .animation-fadeIn{animation-name: animation-fadeIn;-webkit-animation-name: animation-fadeIn; animation-duration: 0.6s; -webkit-animation-duration: 0.6s; animation-timing-function: ease-in-out; -webkit-animation-timing-function: ease-in-out; visibility: visible !important;} @keyframes animation-fadeIn {0% {opacity: 0.0;} 100% {opacity: 1;} } @-webkit-keyframes animation-fadeIn { 0% {opacity: 0.0;} 100% {opacity: 1;} } .formbox-editor_VGQ9D fieldset {border: none;margin: 0;padding: 0 40px;position: relative;} .formbox-editor_VGQ9D fieldset > input,.formbox-editor_VGQ9D fieldset > textarea,.formbox-editable-field_VGQ9D {margin: 10px 0;outline: none;} .spacer-block_VGQ9D {min-height: 20px;padding: 10px 0;position: relative;} .spacer-block-line_VGQ9D {position: absolute;top: 50%;left: 40px;right: 40px;display: none;border-top-style: solid;} .formbox-editor_VGQ9D {margin: 0 auto;padding: 0;text-align: left;width: 100%;box-sizing: border-box;} #formbox_screen_subscribe_VGQ9D, #formbox_screen_success_VGQ9D, #formbox_screen_captcha_VGQ9D {padding: 30px 0;}  .formbox-title_VGQ9D, .formbox-text-field_VGQ9D {margin-bottom: 0; font-family: Helvetica, Arial, sans-serif; color: #000000; font-size: 14px; } .formbox-title_VGQ9D a, .formbox-text-field_VGQ9D a  {text-decoration: none;}  .formbox-title_VGQ9D p, .formbox-text-field_VGQ9D p {margin: 0;margin-bottom: 10px;padding: 0; word-break: break-word;} label.formbox-field-label_VGQ9D {font-family: Helvetica, Arial, sans-serif; display: block; margin: 10px 0 0; padding: 0; font-size: 14px; text-align: left;line-height: 100%; color: #000000;} label.formbox-label-wrap_VGQ9D {font-family: Helvetica, Arial, sans-serif; display: block; margin: 10px 0 0; padding: 0; font-size: 14px; line-height: 100%; padding-left: 15px; text-indent: -15px; font-style: italic;color: #000000;} label.formbox-label-wrap_VGQ9D:last-of-type {margin-bottom: 10px;} label.formbox-label-wrap_VGQ9D input[type=checkbox], label.formbox-label-wrap_VGQ9D input[type=radio] { width: 13px; height: 13px; padding: 0; margin:0; margin-right: 5px; vertical-align: bottom; position: relative; top: -1px; } select.formbox-field_VGQ9D {background-color: #000000; border: 1px solid #e2e2e2; border-radius: 0px; box-sizing: border-box; background-color: #ffffff; font-family: Helvetica, Arial, sans-serif; font-size: 14px; width: 100%; margin: 10px 0; height: auto; padding: 2px 0px;} input.formbox-field_VGQ9D {color: #000000; background-color: #ffffff; border: 1px solid #e2e2e2; border-radius:0px; font-family: Helvetica, Arial, sans-serif; font-size: 14px; box-sizing: border-box; padding:15px; width: 100%;} input.formbox-field_VGQ9D.text-placeholder {color: #c4c4c4; font-weight: normal; font-style: normal; font-family: Helvetica, Arial, sans-serif; font-size: 14px;} .formbox-field_VGQ9D::-webkit-input-placeholder {color: #c4c4c4; font-weight: normal; font-style: normal;opacity: 1;} .formbox-field_VGQ9D::-moz-placeholder { color: #c4c4c4; font-weight: normal; font-style: normal;opacity: 1;} .formbox-field_VGQ9D:-ms-input-placeholder {color: #c4c4c4; font-weight: normal; font-style: normal; opacity: 1;} .formbox-button_VGQ9D {line-height: 100%;  cursor: pointer; margin: 10px 0; } .formbox-button_VGQ9D:hover { background-color:#141414 !important; } .formbox-button_VGQ9D:active { background-color:#000000 !important; }#popupFormLoader_VGQ9D { display: none; position: absolute; bottom: 10px; right: 10px; width: 20px; height: 20px; background-image: url(https://benchmarkemail.com/images/popup-builder/loadingicon.svg); background-position: center center; background-repeat: no-repeat; background-color: rgb(255, 255, 255); background-color: rgba(255, 255, 255, 0.3);  border-radius: 100%; -webkit-animation-name: spin; -webkit-animation-duration: 800ms; -webkit-animation-iteration-count: infinite; -webkit-animation-timing-function: linear; -moz-animation-name: spin; -moz-animation-duration: 800ms; -moz-animation-iteration-count: infinite; -moz-animation-timing-function: linear;-ms-animation-name: spin;-ms-animation-duration: 800ms;-ms-animation-iteration-count: infinite;-ms-animation-timing-function: linear;animation-name: spin;animation-duration: 800ms;animation-iteration-count: infinite;animation-timing-function: linear;}@-moz-keyframes spin {from { -moz-transform: rotate(0deg); }to { -moz-transform: rotate(360deg); }}@-webkit-keyframes spin {from { -webkit-transform: rotate(0deg); }to { -webkit-transform: rotate(360deg); }}@keyframes spin {from {transform:rotate(0deg);}to {transform:rotate(360deg);}}</style>'
);
document.write(
  '<div id="signupFormContainer_VGQ9D" style="display: none;"><div id="signupFormOverlay_VGQ9D"></div><div id="signupFormContent_VGQ9D" class="animation-fadeIn position-centered"><div id="signupFormVeil_VGQ9D"></div><div class="formbox-editor_VGQ9D" style="background: #ffffff; max-width: 375px;border-radius:0px; box-sizing: border-box;"><div id="close-btn_VGQ9D" style="padding: 10px;"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="10px" height="10px" viewBox="0 0 10 10" enable-background="new 0 0 10 10" xml:space="preserve"><polygon points="10,1.3 8.7,0 5,3.7 1.3,0 0,1.3 3.7,5 0,8.7 1.3,10 5,6.3 8.7,10 10,8.7 6.3,5 " data-size="s-close-medium" data-selected="close-medium"></polygon></svg></div><div id="formbox_screen_subscribe_VGQ9D" style="display:block;" name="frmLB"><input type=hidden name=token_VGQ9D id=token_VGQ9D value="mFcQnoBFKMS0koHGGsvfIajgVtVj7bhtd9wS1TyiNsj4AWGTsy30rQ%3D%3D" /><fieldset><div class="formbox-title_VGQ9D"><p style="line-height: 1; text-align: center;" data-mce-style="line-height: 1; text-align: center;"><span style="font-size: 20px;" data-mce-style="font-size: 20px;"><span style="font-family: Helvetica, Arial, sans-serif;" data-mce-style="font-family: Helvetica, Arial, sans-serif;"><strong><span style="color: #000000;" data-mce-style="color: #000000;">TPR&nbsp;</span></strong></span><span style="font-family: Helvetica, Arial, sans-serif;" data-mce-style="font-family: Helvetica, Arial, sans-serif;"><strong><span style="color: #000000;" data-mce-style="color: #000000;">MAILNEWS</span></strong></span></span></p></div></fieldset><fieldset class="formbox-field_VGQ9D"><input type=text placeholder="Name" class="formbox-field_VGQ9D text-placeholder" onfocus="javascript:focusPlaceHolder(this);" onblur="javascript:blurPlaceHolder(this);" id="fldfirstname_VGQ9D" name="fldfirstname_VGQ9D" maxlength=100 /></fieldset><fieldset class="formbox-field_VGQ9D"><input type=text placeholder="Email" class="formbox-field_VGQ9D text-placeholder" onfocus="javascript:focusPlaceHolder(this);" onblur="javascript:blurPlaceHolder(this);" id="fldemail_VGQ9D" name="fldemail_VGQ9D" maxlength=100 /></fieldset><fieldset style="text-align:center;"><div id="btnSubmit_VGQ9D" onClick="javascript:return submit_VGQ9DClick();" style="word-break: break-all; box-sizing: border-box; text-align:center; display: inline-block;width: 100%;padding-left: 15px; padding-right: 15px;padding-top: 15px; padding-bottom: 15px;background-color:rgb(0, 0, 0); border: rgba(0, 0, 0, 0) solid 0px; border-radius: 0px;font-family :Helvetica, Arial, sans-serif; font-size: 14px;font-weight: bold;color: rgb(255, 255, 255); line-height: 1; letter-spacing:0px;" class="formbox-button_VGQ9D">SUBSCRIBE</div></fieldset><div id="popupFormLoader_VGQ9D" style="display: none;"></div></div><div id="formbox_screen_success_VGQ9D" style="display: none;"><fieldset class="formbox-field_VGQ9D"><div class="formbox-editable-field_VGQ9D formbox-text-field_VGQ9D"><p style="color: #000; font-family: Helvetica, Arial, sans-serif; font-size: 20px; line-height: 1;" data-mce-style="color: #000; font-family: Helvetica, Arial, sans-serif; font-size: 20px; line-height: 1;">Thanks for subscribing!</p></div></fieldset><fieldset class="formbox-field_VGQ9D"><div class="formbox-editable-field_VGQ9D formbox-text-field_VGQ9D"><p style="color: #000; font-family: Helvetica, Arial, sans-serif; font-size: 14px; line-height: 1.5;" data-mce-style="color: #000; font-family: Helvetica, Arial, sans-serif; font-size: 14px; line-height: 1.5;">You\'re almost done. Check your email and click the link to confirm your subscription.</p></div></fieldset></div></div></div></div>'
);

function CheckField_VGQ9D(fldName, frm) {
  var fldObj = document.getElementsByName(fldName);
  if (fldObj.length > 1) {
    for (var i = 0, l = fldObj.length; i < l; i++) {
      if (fldObj[0].type == "select-one") {
        if (fldObj[i].selected && i == 0 && fldObj[i].value == "") {
          return false;
        }
        if (fldObj[i].selected) {
          return true;
        }
      } else {
        if (fldObj[i].checked) {
          return true;
        }
      }
    }
    return false;
  } else {
    if (fldObj[0].type == "checkbox") {
      return fldObj[0].checked;
    } else if (fldObj[0].type == "radio") {
      return fldObj[0].checked;
    } else {
      fldObj[0].focus();
      return fldObj[0].value.length > 0;
    }
  }
}

function rmspaces(x) {
  var leftx = 0;
  var rightx = x.length - 1;
  while (x.charAt(leftx) == " ") {
    leftx++;
  }
  while (x.charAt(rightx) == " ") {
    --rightx;
  }
  var q = x.substr(leftx, rightx - leftx + 1);
  if (leftx == x.length && rightx == -1) {
    q = "";
  }
  return q;
}

function checkfield(data) {
  if (rmspaces(data) == "") {
    return false;
  } else {
    return true;
  }
}

function isemail(data) {
  var flag = false;
  if (
    data.indexOf("@", 0) == -1 ||
    data.indexOf("\\", 0) != -1 ||
    data.indexOf("/", 0) != -1 ||
    !checkfield(data) ||
    data.indexOf(".", 0) == -1 ||
    data.indexOf("@") == 0 ||
    data.lastIndexOf(".") < data.lastIndexOf("@") ||
    data.lastIndexOf(".") == data.length - 1 ||
    data.lastIndexOf("@") != data.indexOf("@") ||
    data.indexOf(",", 0) != -1 ||
    data.indexOf(":", 0) != -1 ||
    data.indexOf(";", 0) != -1
  ) {
    return flag;
  } else {
    var temp = rmspaces(data);
    if (temp.indexOf(" ", 0) != -1) {
      flag = true;
    }
    var d3 = temp.lastIndexOf(".") + 4;
    var d4 = temp.substring(0, d3);
    var e2 = temp.length - temp.lastIndexOf(".") - 1;
    var i1 = temp.indexOf("@");
    if (temp.charAt(i1 + 1) == "." || e2 < 1) {
      flag = true;
    }
    return !flag;
  }
}

function focusPlaceHolder(obj) {
  obj.className = "formbox-field_VGQ9D";
}

function blurPlaceHolder(obj) {
  if (obj.value == "") {
    obj.className = "formbox-field_VGQ9D text-placeholder";
  }
}

function isValidDate(year, month, day) {
  if (year.toString() == "" || month.toString() == "" || day.toString() == "") {
    return false;
  }
  try {
    year = parseInt(year);
    month = parseInt(month);
    day = parseInt(day);
  } catch (e) {
    return false;
  }
  var d = new Date(year, month - 1, day, 0, 0, 0, 0);
  return (
    !isNaN(d) &&
    d.getDate() == day &&
    d.getMonth() + 1 == month &&
    d.getFullYear() == year
  );
}

var submitButton_VGQ9D = document.getElementById("btnSubmit_VGQ9D");
var subscribeScreen_VGQ9D = document.getElementById(
  "formbox_screen_subscribe_VGQ9D"
);
var successScreen_VGQ9D = document.getElementById(
  "formbox_screen_success_VGQ9D"
);
var signupFormContainer_VGQ9D = document.getElementById(
  "signupFormContainer_VGQ9D"
);
var signupFormVeil_VGQ9D = document.getElementById("signupFormVeil_VGQ9D");
var signupFormCloseButton_VGQ9D = document.getElementById("close-btn_VGQ9D");
var signupFormLoader_VGQ9D = document.getElementById("popupFormLoader_VGQ9D");

function submit_VGQ9DClick() {
  var retVal = true;
  var contentdata = "";
  var frm = document.getElementById("formbox_screen_subscribe_VGQ9D");
  if (!isemail(document.getElementsByName("fldemail_VGQ9D")[0].value)) {
    alert("Please enter the Email Address");
    document.getElementById("fldemail_VGQ9D").focus();
    retVal = false;
  }
  if (retVal == true) {
    var data =
      "token=" +
      encodeURIComponent(document.getElementById("token_VGQ9D").value);
    data =
      data +
      "&" +
      "fldfirstname=" +
      encodeURIComponent(document.getElementById("fldfirstname_VGQ9D").value);
    data =
      data +
      "&" +
      "fldemail=" +
      encodeURIComponent(document.getElementById("fldemail_VGQ9D").value);
    submitFormData_VGQ9D(data);

    if (
      isemail(document.getElementById("fldemail_VGQ9D").value) &&
      window &&
      window.JB_TRACKER &&
      typeof window.JB_TRACKER.jbSubmitForm === "function"
    ) {
      window.JB_TRACKER.jbSubmitForm({
        email: document.getElementById("fldemail_VGQ9D").value,
        didSubmit: true,
      });
    }

    return retVal;
  }
}
var BMESFloaded_VGQ9D = false;
var popupFormSubmitting_VGQ9D = false;

function submitFormData_VGQ9D(data) {
  if (BMESFloaded_VGQ9D == false && popupFormSubmitting_VGQ9D == false) {
    popupFormSubmitting_VGQ9D = true;
    checkLoading_VGQ9D();
    var oldObj = document.getElementById("img_VGQ9D");
    try {
      if (oldObj != null) {
        document
          .getElementById("formbox_screen_subscribe_VGQ9D")
          .removeChild(oldObj);
      }
    } catch (e) {}
    var rand = Math.random();
    var objImg = document.createElement("img");
    objImg.id = "img_VGQ9D";
    objImg.onload = function () {
      popupFormSubmitting_VGQ9D = false;
      BMESFloaded_VGQ9D = true;
      checkLoading_VGQ9D();
    };
    objImg.onerror = function (e) {
      popupFormSubmitting_VGQ9D = false;
      BMESFloaded_VGQ9D = false;
      checkLoading_VGQ9D();
      errorLoading_VGQ9D(e);
    };
    objImg.src =
      "https://lb.benchmarkemail.com//code/lbform/api?" +
      data +
      "&inst=" +
      rand;
    objImg.style.display = "none";
    checkLoaded_VGQ9D();
    document
      .getElementById("formbox_screen_subscribe_VGQ9D")
      .appendChild(objImg);
  } else if (popupFormSubmitting_VGQ9D == true) {
    alert("Saving, please wait...");
  }
}

function checkLoading_VGQ9D(e) {
  if (popupFormSubmitting_VGQ9D == true) {
    signupFormLoader_VGQ9D.style.display = "block";
  } else {
    signupFormLoader_VGQ9D.style.display = "none";
  }
}

function errorLoading_VGQ9D(e) {
  alert("There was an error. Please try after some time");
  BMESFloaded_VGQ9D = false;
}

let checkSuccess = false;

function checkLoaded_VGQ9D() {
  if (BMESFloaded_VGQ9D == false) {
    setTimeout(checkLoaded_VGQ9D, 100);
  } else {
    var wd = document.getElementById("img_VGQ9D").width;
    if (wd == 1) {
      subscribeScreen_VGQ9D.style.display = "none";
      localStorage.setItem("bmePopupFormSignedUp1747194", "true");
      checkSuccess = true;
      verticalCenter_VGQ9D(successScreen_VGQ9D);
    } else {
      BMESFloaded_VGQ9D = false;
      subscribeScreen_VGQ9D.style.display = "block";
      if (wd == 2) {
        alert("This email address already exists. ");
        document.getElementById("fldemail_VGQ9D").focus();
      } else if (wd == 3 || wd == 4) {
        alert("Invalid email address.");
        document.getElementById("fldemail_VGQ9D").focus();
      } else if (wd == 6) {
        alert("This email address has previously unsubscribed");
        document.getElementById("fldemail_VGQ9D").focus();
      } else {
        alert("There was an error. Please try after some time");
        document.getElementById("fldemail_VGQ9D").focus();
      }
    }
  }
}

signupFormCloseButton_VGQ9D.addEventListener("click", function () {
  document.body.classList.toggle("active");
  const element = document.getElementById("signupFormContainer_VGQ9D");
  if (element) {
    element.style.transition = "opacity 400ms";
    element.style.opacity = 0;
    element.addEventListener(
      "transitionend",
      function () {
        element.style.display = "none";
      },
      { once: true }
    ); // Listener tự gỡ sau khi chạy một lần
  }
  // $("#signupFormContainer_VGQ9D").fadeOut("");
  // signupFormContainer_VGQ9D.style.display = "none";
});

var bmePopupFormViewed_VGQ9D = localStorage.getItem(
  "bmePopupFormSignedUp1747194"
);
if (bmePopupFormViewed_VGQ9D != "true") {
  setTimeout(function () {
    verticalCenter_VGQ9D(signupFormContainer_VGQ9D);
  }, 3 * 1000);
}

function debounce_VGQ9D(func, wait, immediate) {
  var timeout;
  return function () {
    var context = this,
      args = arguments;
    var later = function () {
      timeout = null;
      if (!immediate) func.apply(context, args);
    };
    var callNow = immediate && !timeout;
    clearTimeout(timeout);
    timeout = setTimeout(later, wait);
    if (callNow) func.apply(context, args);
  };
}
var hasVerticalCenter_VGQ9D =
  document.getElementsByClassName("position-centered");

function verticalCenter_VGQ9D(element, key) {
  if (element) {
    // element.style.opacity = 0;
    // element.style.display = "block";
  }

  if (checkSuccess) {
    element.style.display = "block";
  }

  setTimeout(function () {
    if (hasVerticalCenter_VGQ9D.length > 0) {
      var windowHeight = Math.max(
        document.documentElement.clientHeight,
        window.innerHeight || 0
      );
      var formElement_VGQ9D = document.getElementsByClassName(
        "formbox-editor_VGQ9D"
      )[0];
      var formHeight_VGQ9D = formElement_VGQ9D.clientHeight;
      if (formHeight_VGQ9D < windowHeight) {
        var newPosition = 0;
        // newPosition = (windowHeight - formHeight_VGQ9D) / 2;
        // formElement_VGQ9D.style.top = newPosition + "px";
        // formElement_VGQ9D.style.top = "37%";
        newPosition = (windowHeight - 288) / 2;
        formElement_VGQ9D.style.top = newPosition + "px";
      } else {
        // formElement_VGQ9D.style.top = "0px";
        formElement_VGQ9D.style.top = "37%";
      }
    }
    if (element) {
      element.style.opacity = 1;
    }
  }, 100);
}

if (hasVerticalCenter_VGQ9D.length > 0) {
  var resizeEvent_VGQ9D = debounce_VGQ9D(function () {
    verticalCenter_VGQ9D();
  }, 250);
  window.addEventListener("resize", resizeEvent_VGQ9D);
}

var subscribeButton = document.getElementById("subscribeBtn");
subscribeBtn.addEventListener("click", function () {
  document.body.classList.toggle("active");
  signupFormContainer_VGQ9D.style.display = "block";
  signupFormContainer_VGQ9D.style.opacity = 1;
});

["pageshow", "load"].forEach((evt) => {
  window.addEventListener(evt, () => {
    signupFormContainer_VGQ9D.style.display = "none";

    setTimeout(() => {
      verticalCenter_VGQ9D();
    }, 500);
  });
});
